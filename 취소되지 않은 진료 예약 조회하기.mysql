-- 코드를 입력하세요
WITH APPOINTMENT_WITH_DOCTOR_NAME AS
(
    SELECT * 
    FROM  
        (SELECT DR_ID, DR_NAME FROM DOCTOR) d
        JOIN 
        APPOINTMENT a 
        ON d.DR_ID = a.MDDR_ID
)

SELECT a.APNT_NO, p.PT_NAME, p.PT_NO, a.MCDP_CD, a.DR_NAME, a.APNT_YMD
FROM PATIENT p JOIN APPOINTMENT_WITH_DOCTOR_NAME a
ON p.PT_NO = a.PT_NO
WHERE a.MCDP_CD = 'CS'
      AND
      a.APNT_YMD LIKE '2022-04-13%'
      AND
      (a.APNT_CNCL_YN = 'N' OR a.APNT_CNCL_YMD > '2022-04-13') 
ORDER BY APNT_YMD
